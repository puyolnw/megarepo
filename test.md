# คู่มือการทดสอบระบบ (Test Guide)

## ภาพรวมการทดสอบ
เอกสารนี้เป็นคู่มือสำหรับการทดสอบฟีเจอร์ใหม่ที่เพิ่มเข้ามาในระบบ หลังจากที่ได้ทำการแก้ไขและเพิ่มฟีเจอร์ต่างๆ ตามที่ระบุใน tasks.md

## วิธีการเริ่มต้นการทดสอบ

### 1. เริ่มต้นเซิร์ฟเวอร์
```bash
# ไปที่โฟลเดอร์ back
cd back

# รันเซิร์ฟเวอร์
node server.js
```

### 2. เริ่มต้น Frontend (ใน terminal ใหม่)
```bash
# ไปที่โฟลเดอร์ front
cd front

# รัน frontend
npm run dev
```

### 3. เข้าสู่ระบบ
- เปิดเบราว์เซอร์ไปที่ `http://localhost:3000` (หรือ port ที่ frontend รัน)
- เข้าสู่ระบบด้วยบัญชีที่มีสิทธิ์ ADMIN หรือ STUDENT

## การทดสอบฟีเจอร์ใหม่

### 1. ทดสอบหน้า Test Page
**เส้นทาง:** `/test` (หน้าเทส API และ Frontend)

**สิ่งที่ต้องทดสอบ:**
- [ ] หน้า Test Page โหลดได้ปกติ
- [ ] แสดงข้อมูลผู้ใช้ปัจจุบัน
- [ ] มี dropdown สำหรับเลือกปีการศึกษา
- [ ] มีปุ่ม "รันเทสทั้งหมด"

**การทดสอบ API Endpoints:**
1. **Public Test** - ทดสอบ endpoint ที่ไม่ต้องการ authentication
   - [ ] คลิก "Run Test" ควรได้ผลลัพธ์ success
   - [ ] ไม่ควรมี error 403 Forbidden

2. **System Status** - ทดสอบสถานะระบบ
   - [ ] คลิก "Run Test" ควรแสดงข้อมูลสถิติระบบ
   - [ ] ควรแสดงจำนวน users, activities, academic years

3. **Academic Years** - ทดสอบข้อมูลปีการศึกษา
   - [ ] คลิก "Run Test" ควรแสดงรายการปีการศึกษา
   - [ ] ข้อมูลควรมี year, year_thai, start_date, end_date

4. **Activities with Academic Year** - ทดสอบกิจกรรมพร้อมปีการศึกษา
   - [ ] คลิก "Run Test" ควรแสดงรายการกิจกรรม
   - [ ] กิจกรรมควรมีข้อมูล academic year

5. **Activity CRUD Test** - ทดสอบฟิลด์ใหม่ของกิจกรรม
   - [ ] คลิก "Run Test" ควรแสดงกิจกรรมพร้อมฟิลด์ใหม่
   - [ ] ควรมี location, max_participants, rescheduled_date

6. **Student Progress by Year** - ทดสอบความก้าวหน้านักศึกษาตามปีการศึกษา
   - [ ] เลือกปีการศึกษาจาก dropdown
   - [ ] คลิก "Run Test" ควรแสดงข้อมูลความก้าวหน้า
   - [ ] ควรแสดง totalHours, activityCount, activities

7. **Member Reports by Year** - ทดสอบรายงานสมาชิกตามปีการศึกษา
   - [ ] เลือกปีการศึกษาจาก dropdown
   - [ ] คลิก "Run Test" ควรแสดงข้อมูลรายงาน
   - [ ] ควรแสดง academicYearProgress

### 2. ทดสอบการเปลี่ยนชื่อแดชบอร์ด
**เส้นทาง:** `/admin` (หน้าแดชบอร์ดผู้ดูแลระบบ)

**สิ่งที่ต้องทดสอบ:**
- [ ] ชื่อหน้าเปลี่ยนจาก "แดชบอร์ดผู้ดูแลระบบ" เป็น "ผู้ดูแลระบบ"
- [ ] Navbar แสดงชื่อใหม่
- [ ] DashboardNavbar แสดงชื่อใหม่

### 3. ทดสอบการสร้างกิจกรรมพร้อมปีการศึกษา
**เส้นทาง:** `/admin/create-activity`

**สิ่งที่ต้องทดสอบ:**
- [ ] มี dropdown สำหรับเลือกปีการศึกษา
- [ ] สามารถเลือกปีการศึกษาได้
- [ ] สร้างกิจกรรมได้สำเร็จพร้อมปีการศึกษา
- [ ] ข้อมูลปีการศึกษาถูกบันทึกในฐานข้อมูล

### 4. ทดสอบการจัดการกิจกรรม (CRUD)
**เส้นทาง:** `/admin/activities`

**สิ่งที่ต้องทดสอบ:**
- [ ] มีปุ่ม "แก้ไข" สำหรับแต่ละกิจกรรม
- [ ] มีปุ่ม "เลื่อนวัน" สำหรับแต่ละกิจกรรม
- [ ] มีปุ่ม "ยกเลิก" สำหรับแต่ละกิจกรรม
- [ ] มีปุ่ม "ลบ" สำหรับแต่ละกิจกรรม

**การทดสอบแต่ละฟังก์ชัน:**
1. **แก้ไขกิจกรรม:**
   - [ ] คลิกปุ่ม "แก้ไข"
   - [ ] Modal แก้ไขเปิดขึ้น
   - [ ] สามารถแก้ไขข้อมูลได้
   - [ ] บันทึกการแก้ไขได้สำเร็จ

2. **เลื่อนวันกิจกรรม:**
   - [ ] คลิกปุ่ม "เลื่อนวัน"
   - [ ] Modal เลื่อนวันเปิดขึ้น
   - [ ] สามารถเลือกวันที่ใหม่ได้
   - [ ] บันทึกการเลื่อนวันได้สำเร็จ

3. **ยกเลิกกิจกรรม:**
   - [ ] คลิกปุ่ม "ยกเลิก"
   - [ ] Modal ยกเลิกเปิดขึ้น
   - [ ] ยืนยันการยกเลิกได้
   - [ ] สถานะกิจกรรมเปลี่ยนเป็น CANCELLED

4. **ลบกิจกรรม:**
   - [ ] คลิกปุ่ม "ลบ"
   - [ ] Modal ลบเปิดขึ้น
   - [ ] ยืนยันการลบได้
   - [ ] กิจกรรมถูกลบออกจากรายการ

### 5. ทดสอบรายงานนักศึกษา
**เส้นทาง:** `/admin/reports` (หน้า Member Reports)

**สิ่งที่ต้องทดสอบ:**
- [ ] ชื่อหน้าเปลี่ยนจาก "รายงานสมาชิก" เป็น "รายงานนักศึกษา"
- [ ] มี filter สำหรับเลือกปีการศึกษา
- [ ] มีกราฟแสดงข้อมูลตามปีการศึกษา
- [ ] มีกราฟแสดงกิจกรรมในแต่ละปีการศึกษา

**การทดสอบกราฟ:**
1. **กราฟความก้าวหน้าตามปีการศึกษา:**
   - [ ] แสดงข้อมูลชั่วโมงสะสมในแต่ละปีการศึกษา
   - [ ] กราฟแสดงผลถูกต้อง

2. **กราฟกิจกรรมตามปีการศึกษา:**
   - [ ] แสดงจำนวนกิจกรรมในแต่ละปีการศึกษา
   - [ ] กราฟแสดงผลถูกต้อง

### 6. ทดสอบชั่วโมงกิจกรรม
**เส้นทาง:** `/student/progress` (หน้า Student Progress)

**สิ่งที่ต้องทดสอบ:**
- [ ] ชื่อหน้าเปลี่ยนจาก "ความก้าวหน้าของฉัน" เป็น "ชั่วโมงกิจกรรม"
- [ ] มี dropdown สำหรับเลือกปีการศึกษา
- [ ] แสดงข้อมูลชั่วโมงสะสมตามปีการศึกษา
- [ ] แสดงข้อมูลในกรอบสีเขียว

**การทดสอบข้อมูล:**
- [ ] เลือกปีการศึกษาและแสดงข้อมูลถูกต้อง
- [ ] แสดงจำนวนชั่วโมงสะสมในปีการศึกษานั้น
- [ ] แสดงรายการกิจกรรมที่เข้าร่วม

### 7. ทดสอบการจัดการปีการศึกษา
**เส้นทาง:** `/admin/academic-years`

**สิ่งที่ต้องทดสอบ:**
- [ ] แสดงรายการปีการศึกษาทั้งหมด
- [ ] สามารถเพิ่มปีการศึกษาใหม่ได้
- [ ] สามารถแก้ไขปีการศึกษาได้
- [ ] สามารถลบปีการศึกษาได้
- [ ] สามารถตั้งค่าปีการศึกษาปัจจุบันได้

## การทดสอบฐานข้อมูล

### ตรวจสอบตารางใหม่
```sql
-- ตรวจสอบตาราง academic_years
SELECT * FROM academic_years;

-- ตรวจสอบฟิลด์ใหม่ในตาราง activities
DESCRIBE activities;

-- ตรวจสอบข้อมูลกิจกรรมพร้อมปีการศึกษา
SELECT id, title, academic_year, academic_year_id, location, max_participants, rescheduled_date, status 
FROM activities 
WHERE academic_year IS NOT NULL;
```

### ตรวจสอบข้อมูลตัวอย่าง
```sql
-- ตรวจสอบจำนวนปีการศึกษา
SELECT COUNT(*) as total_academic_years FROM academic_years;

-- ตรวจสอบกิจกรรมที่มีปีการศึกษา
SELECT COUNT(*) as activities_with_year FROM activities WHERE academic_year IS NOT NULL;

-- ตรวจสอบกิจกรรมที่มีสถานะ CANCELLED
SELECT COUNT(*) as cancelled_activities FROM activities WHERE status = 'CANCELLED';
```

## การทดสอบ API โดยตรง

### ทดสอบ API Endpoints
```bash
# ทดสอบ public test endpoint
curl http://localhost:4000/api/test/public-test

# ทดสอบ system status (ต้องมี token)
curl -H "Authorization: Bearer YOUR_TOKEN" http://localhost:4000/api/test/system-status

# ทดสอบ academic years (ต้องมี token)
curl -H "Authorization: Bearer YOUR_TOKEN" http://localhost:4000/api/test/academic-years
```

## สิ่งที่ต้องตรวจสอบเมื่อเกิดปัญหา

### ปัญหา 404 Not Found
- [ ] ตรวจสอบว่าเซิร์ฟเวอร์รันอยู่ที่ port 4000
- [ ] ตรวจสอบว่า test routes ถูกเพิ่มใน server.js
- [ ] ตรวจสอบว่าไฟล์ routes/test.js มีอยู่

### ปัญหา 403 Forbidden
- [ ] ตรวจสอบว่าเข้าสู่ระบบแล้ว
- [ ] ตรวจสอบว่า token ยังไม่หมดอายุ
- [ ] ตรวจสอบว่า user มี role ที่ถูกต้อง (ADMIN หรือ STUDENT)

### ปัญหา 500 Internal Server Error
- [ ] ตรวจสอบ console ของเซิร์ฟเวอร์
- [ ] ตรวจสอบการเชื่อมต่อฐานข้อมูล
- [ ] ตรวจสอบว่า models ถูก import ถูกต้อง

## สรุปผลการทดสอบ

หลังจากทดสอบเสร็จแล้ว ให้บันทึกผลการทดสอบ:

### ✅ ฟีเจอร์ที่ทำงานได้ปกติ
- [ ] หน้า Test Page
- [ ] การเปลี่ยนชื่อแดชบอร์ด
- [ ] การสร้างกิจกรรมพร้อมปีการศึกษา
- [ ] การจัดการกิจกรรม (CRUD)
- [ ] รายงานนักศึกษา
- [ ] ชั่วโมงกิจกรรม
- [ ] การจัดการปีการศึกษา

### ❌ ฟีเจอร์ที่มีปัญหา
- [ ] ระบุปัญหาที่พบ
- [ ] บันทึก error message
- [ ] บันทึกขั้นตอนที่ทำให้เกิดปัญหา

### 📝 ข้อเสนอแนะ
- [ ] ฟีเจอร์ที่ควรปรับปรุง
- [ ] UI/UX ที่ควรแก้ไข
- [ ] Performance ที่ควรปรับปรุง

---

**หมายเหตุ:** หากพบปัญหาใดๆ ระหว่างการทดสอบ ให้บันทึกข้อมูลและรายละเอียดของปัญหาเพื่อนำไปแก้ไขต่อไป
